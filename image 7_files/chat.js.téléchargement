var _quickchat=function(){"use strict";var B,z,D;var a=(t=>(t.CONFIGURATION="configuration",t.CONVERSATION="conversation",t.MINIMIZE="minimize",t.MAXIMIZE="maximize",t.MINIMIZE_EMBEDDED="minimize_embedded",t.MAXIMIZE_EMBEDDED="maximize_embedded",t.CLOSE="close",t.RESET="reset",t.MESSAGE="message",t.VISIBILITY="visibility",t.CHANGE="change",t))(a||{}),l=(t=>(t.TOP_LEFT="top-left",t.TOP_RIGHT="top-right",t.BOTTOM_LEFT="bottom-left",t.BOTTOM_RIGHT="bottom-right",t))(l||{}),h=(t=>(t.SMALL="small",t.MEDIUM="medium",t.LARGE="large",t))(h||{}),u=(t=>(t.SCENARIO="scenario_id",t.SERVER="server_url",t.CONVERSATION="conversation_id",t.SOURCE="source",t.PREVIEW="preview",t.STANDALONE="standalone",t.PARAMS="params",t.API_KEY="api_key",t.FULL_PATH="full_path",t))(u||{});const _="__qc_conversation",E="quickchat";localStorage.setItem(_,localStorage.get);let A=!1;const d=window.matchMedia("(min-width: 768px)"),y=24,G=280,I=104;let p=null,b=null,S=null,O=null,x=null,c,r,n,s;function T(){var t;r===null||n===null||(m(n,()=>{f(r)}),(t=n.contentWindow)==null||t.postMessage({type:a.MAXIMIZE},"https://widget.quickchat.ai"),$())}function R(){var t;r===null||n===null||(m(r,()=>{f(n)}),(t=n.contentWindow)==null||t.postMessage({type:a.MINIMIZE},"https://widget.quickchat.ai"))}window.addEventListener("message",t=>{if(t.source===(r==null?void 0:r.contentWindow)||t.source===(n==null?void 0:n.contentWindow)||t.source===(s==null?void 0:s.contentWindow)){if(t.data.type===a.MINIMIZE){R();return}if(t.data.type===a.MAXIMIZE){T();return}if(t.data.type===a.CONFIGURATION){if(A)return;const i=JSON.parse(t.data.data);Z(c,i),P(r,i),i.window_auto_open?(n=M(c,i),f(r)):i.popup_active?(s=W(c,i),n=M(c,i),f(n,function(){f(s)})):(n=M(c,i),f(n)),setTimeout(()=>{let o=n.contentDocument;o&&(o.title=i.prechat_header_text??i.author_ai_text);let e=s==null?void 0:s.contentDocument;e&&(e.title=i.prechat_header_text??i.author_ai_text),r&&(r.title=i.prechat_header_text??i.author_ai_text),n&&(n.title=i.prechat_header_text??i.author_ai_text),s&&(s.title=i.prechat_header_text??i.author_ai_text),r&&(r.title=i.prechat_header_text??i.author_ai_text)},100),A=!0;return}if(t.data.type===a.CONVERSATION){const i=JSON.parse(t.data.data);localStorage.setItem(`${_}_${p}`,i.conv_id);return}if(t.data.type===a.CLOSE&&$(),t.data.type===a.RESET&&localStorage.removeItem(`${_}_${p}`),t.data.type===a.VISIBILITY){const i=t.data.rect;s!==void 0&&(d.matches?s.style.height=`${i.height+76}px`:s.style.height=`${i.height+y*2}px`,s.style.width=`${i.width+1+y*2}px`)}}});function q(){x=localStorage.getItem(`${_}_${p}`),c=Y(),r=k(c),document.body.insertAdjacentElement("beforeend",c)}function H(){const t=new URLSearchParams;if(S!==null)try{t.append(u.PARAMS,JSON.stringify(S))}catch{throw new Error("Invalid custom props")}if(x!==null&&t.append(u.CONVERSATION,x),p===null||b===null)throw new Error("Missing scenario or host");return O!==null&&t.append(u.SOURCE,O),t.append(u.SCENARIO,p),t.append(u.SERVER,b),t}function W(t,i){const o=document.createElement("iframe"),e=new URLSearchParams;return e.append("text",i.welcome_messages[0]),e.append("position",i.location),o.id=`${E}-message`,o.src=g("/message",e),C(o,i),t.appendChild(o),o}function C(t,i){const o=`${G}px`,e=d.matches?w(i.size):w(h.SMALL);t.style.width=o,t.style.height=o,t.style.border="none",t.style.display="none",t.style.transition="transform 0.2s ease-in-out, opacity 0.2s ease-in-out",t.style.transform="translateY(100%)",t.style.opacity="0",t.style.position="fixed",t.style.maxWidth=o,i.location===l.BOTTOM_LEFT&&(t.style.left="0",d.matches||(t.style.marginLeft=`${y/-2}px`)),i.location===l.BOTTOM_RIGHT&&(t.style.right="0",d.matches||(t.style.marginRight=`${y/-2}px`)),t.style.bottom=`${e-y+(d.matches?0:y*-1)}px`}function $(){s!==void 0&&(c.removeChild(s),s.remove(),s=void 0)}function k(t){const i=document.createElement("iframe");return i.id=`${E}-messages`,i.src=g("/messages",H()),i.allow="microphone",i.style.display="none",i.referrerPolicy="unsafe-url",t.appendChild(i),i}function P(t,i){t.style.transition="transform 0.2s ease-in-out, opacity 0.2s ease-in-out",t.style.transform="translateY(100%)",t.style.opacity="0",t.style.zIndex="2",t.style.position="fixed",t.style.overflow="hidden",t.style.border="none",L(t,i),d.addEventListener("change",o=>{L(t,i)})}function L(t,i){if(!d.matches)t.style.width="100%",t.style.maxWidth="100%",t.style.height="100%",t.style.bottom="0",t.style.left="0",t.style.right="0",t.style.maxHeight="auto",t.style.borderRadius="0",t.style.boxShadow="none";else{const o=`${y}px`;t.style.borderRadius="16px",t.style.boxShadow="0 0 16px 0 rgba(0, 0, 0, 0.1)",t.style.width=`${i.window_width}px`,t.style.maxWidth=`${i.window_width}px`,t.style.height=`${i.window_height}px`,t.style.maxHeight="100%",i.location===l.BOTTOM_LEFT?(t.style.bottom=o,t.style.left=o,t.style.right="auto"):i.location===l.BOTTOM_RIGHT&&(t.style.bottom=o,t.style.right=o,t.style.left="auto")}}function M(t,i){const o=document.createElement("iframe"),e=new URLSearchParams;return i.bubble_icon_url!==null&&e.append("bubble_icon_url",i.bubble_icon_url),i.primary_color!==null&&e.append("primary_color",i.primary_color),window.top!==null&&(e.append(u.FULL_PATH,window.top.location.href),localStorage.setItem("full_path",window.top.location.href??"")),o.id=`${E}-bubble`,o.src=g("/bubble",e),V(o,i),t.appendChild(o),o}function V(t,i){t.style.border="none",t.style.position="absolute",t.style.zIndex="1",t.style.transition="transform 0.2s ease-in-out, opacity 0.2s ease-in-out",t.style.display="none",t.style.transform="translateY(100%)",t.style.opacity="0",N(t,i),d.addEventListener("change",()=>{N(t,i)})}function N(t,i){if(d.matches){const o=`${w(i.size)}px`;t.style.width=o,t.style.maxWidth=o,t.style.height=o,t.style.margin="0",i.location===l.BOTTOM_LEFT?(t.style.bottom="0",t.style.left="0"):i.location===l.BOTTOM_RIGHT&&(t.style.bottom="0",t.style.right="0")}else{const o=`${w(h.SMALL)}px`,e=`${y/-2}px`;t.style.width=o,t.style.maxWidth=o,t.style.height=o,i.location===l.BOTTOM_LEFT?(t.style.margin=`0 0 ${e} ${e}`,t.style.bottom="0",t.style.left="0"):i.location===l.BOTTOM_RIGHT&&(t.style.margin=`0 ${e} ${e} 0`,t.style.bottom="0",t.style.right="0")}}function g(t,i){return window.top!==null&&i.append(u.FULL_PATH,window.top.location.href),`https://widget.quickchat.ai${t}.html?${i.toString()}&timestamp=${Date.now()}`}function Y(){const t=document.createElement("div");return t.id=`${E}-root`,t.style.position="fixed",t.style.zIndex="calc(infinity)",t}function Z(t,i){i.location===l.BOTTOM_LEFT?(t.style.bottom="0",t.style.left="0"):i.location===l.BOTTOM_RIGHT&&(t.style.bottom="0",t.style.right="0")}function f(t,i=null){t.style.display="block",setTimeout(()=>{if(i!==null){const o=()=>{t.removeEventListener("transitionend",o),i()};t.addEventListener("transitionend",o)}t.style.transform="translateY(0)",t.style.opacity="1"},100)}function m(t,i=null){const o=()=>{t.style.display="none",t.removeEventListener("transitionend",o),i!==null&&i()};t.addEventListener("transitionend",o),t.style.transform="translateY(100%)",t.style.opacity="0"}function w(t=h.MEDIUM){return t===h.SMALL?I*.9:t===h.LARGE?I*1.1:I}function v(t,i){var o;if(t==="init"){p=i,q();return}if(t==="host"){b=i;return}t==="custom_params"&&(S=i),t==="source"&&(O=i),t==="message"&&(T(),(o=r.contentWindow)==null||o.postMessage({type:a.MESSAGE,message:i},"https://widget.quickchat.ai")),t==="open"&&T(),t==="close"&&R()}return((z=(B=window._quickchat)==null?void 0:B.q)==null?void 0:z.length)>0&&(window._quickchat.q.forEach(t=>{v(...t)}),(D=window._quickchat)==null||delete D.q),v}();
